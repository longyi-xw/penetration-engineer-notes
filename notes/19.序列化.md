# 序列化和反序列化漏洞

## 什么是序列化

将特定编程语言中的对象或者变量通过函数序列化成通用的二进制、json、字符串等数据格式进行存储或者传输

## 什么是反序列化

即将通用的字符串、二进制、json等通用数据格式传递给程序，然后反序列化成不同语言中的对象或者变量进行使用

## 是什么反序列化漏洞

通过基础的反序列化参数注入，改变反序列化的内容，当执行程序将数据反序列化后，如果程序中使用反序列化后的对象或者变量存在
逻辑漏洞，从而可能造成系统命令或数据更改的漏洞利用

## php原生类反序列漏洞

注：需要保证php语言中的原生类扩展开启

当发现需要触发执行的php文件没有任何可触发点的时候，但是又存在反序列化漏洞，则可以从语言本身的原生类入手
某些原生类本身存在执行服务器php文件的能力，则可以通过反序列化漏洞构造语言原生类使用ssrf漏洞触发执行服务器
上的服务器程序，达到攻击目的

## php原生类结合xss漏洞

通过php的原生底层类，例如exception类，触发_tostring函数，将序列化字符串的xss攻击脚本写入到序列化逻辑中
从而达到xss攻击注入

## Java序列化

java序列化漏洞和php类似，但是java序列化后到数据格式和php有很大区别，java序列化后的格式大多为16进制的数据
但是java反序列化漏洞编写，有常见的ys*脚本工具可以构造payload数据

## Python 序列化

python序列化更容易攻击成功，python序列化通过 dumps进行序列化成字节流，将字节流对象传递给loads进行反序列操作
当class类检测到loads被调用时，则会触发python魔术方法，从而达到脚本执行的目的，可以自己编写class类伪造反序列化字节流
